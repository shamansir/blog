<!DOCTYPE html>

<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta charset="utf-8" />

<meta name="author" content="Ulric Wilfred" />
<meta name="description" content="Blog about programming and only about it. No word about onion. At all. Totally none." />
<meta name="generator" content="mynt v0.2.3-dev" />

<link rel="author me ext" href="http://shamansir.github.com" />
<link rel="contents start home" href="/blog/" />
<link rel="index" href="/blog/archives/" />

<link rel="shortcut icon" href="/blog/assets/img/favicon.png" type="image/x-icon" />

<link rel="alternate" href="/blog/feed.xml" type="application/atom+xml" />

<link rel="stylesheet" href="/blog/assets/css/screen.css" media="screen, projection" type="text/css" />
<link rel="stylesheet" href="/blog/assets/css/print.css" media="print" type="text/css" />
  <!--[if IE]>
      <link rel="stylesheet" href="/blog/assets/css/ie.css" media="screen, projection" type="text/css" />
  <![endif]-->
<link rel="stylesheet" href="/blog/assets/css/pygments.trac.css" type="text/css" />

<!-- Font Awesome - http://fortawesome.github.com/Font-Awesome -->
<link rel="stylesheet" href="/blog/assets/css/font-awesome.css" />


    <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-20770637-4']);
        _gaq.push(['_trackPageview']);
        
        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>

    
    <title>nwao — 3 Tiny JavaScript Snippets &ndash; No word about onion</title>

</head>

<body>
    <div id="nwao-page">
        <div id="nwao-header">
            <div id="nwao-holder">
                <nav id="nwao-nav"><ul>
                    <li><a href="/blog/" rel="contents" title="Blog"><i class="icon-home"></i>&nbsp;Blog</a></li>
                    <li><a href="/blog/archives/" rel="index" title="Archives"><i class="icon-book"></i>&nbsp;Archives</a></li>
                    <li><a href="http://shamansir.github.com" rel="author" title="Author"><i class="icon-user"></i>&nbsp;Author</a></li>
                    <!-- TODO: TAGS PAGE -->
                    <li><a href="/blog/feed.xml" title="Feed"><i class="icon-rss"></i>&nbsp;Feed</a></li>
                </ul></nav>

                <h1 id="nwao-title"><a href="/blog/" title="No word about onion">&raquo;No word about onion&laquo;</a></h1>
            </div>
            <div id="nwao-subtitle"><span>shaman.sir's telling you about stuff</span></div>
        </div>

        <!--
        <nav>
          <div id="nwao-dive">
            <a href="#" id="nwao-prev">← Previous post</a><span> | </span>
            <a href="#" id="nwao-next">Next post →</a>
          </div>
        </nav>
        -->
        
        <div id="nwao-content">
            
    <article id="nwao-post">
        <div class="nwao-post-header">
            <h2 class="nwao-post-title" id="top">
                <a href="#top" title="3 Tiny JavaScript Snippets">
                    3 Tiny JavaScript Snippets
                </a>
            </h2>
            <dl>
    <dt class="nwao-hidden">Published at</dt>
    <dd class="nwao-published"><i class="icon-time"></i>&nbsp;03 February 2011, Thursday</dd>
    
    <dt class="nwao-hidden">Tags</dt>
    <dd class="nwao-tags">
    
        <a href="/blog/tags/javascript/" rel="tag" title="Posts with 'javascript' tag"><i class="icon-tag"></i>&nbsp;javascript</a><span class="nwao-hidden">,</span> 
    
        <a href="/blog/tags/web-dev/" rel="tag" title="Posts with 'web-dev' tag"><i class="icon-tag"></i>&nbsp;web-dev</a>
    
    </dd>
    
</dl>
        </div>
        
        <div class="nwao-post-content">
            <p>Currently I am doing some stuff in JavaScript and I need to have just a tiny amounts of code to work with. As tiny as this article. But there are some things I really need to make the development comfortable for myself. So I require them to be tiny too.</p>
<h3 id="two-liner-each-one-function"><a href="#two-liner-each-one-function" title="Two-Liner Each (one function)">Two-Liner Each (one function)</a></h3>
<p>Works just with objects and arrays. For objects, callback takes key and value. For arrays, callback takes element.</p>
<div class="code"><div><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span class="cm">/**</span>
<span class="cm"> * Tiny each</span>
<span class="cm"> * @param {Array, Object} iterable the iterable to iterate through</span>
<span class="cm"> * @param {Function} func to call on each iteration, in array-mode gets an element (func(elem)),</span>
<span class="cm">                                                     in object-mode gets a key and value (func(v, k))</span>
<span class="cm"> */</span>
<span class="kd">function</span> <span class="nx">each</span><span class="p">(</span><span class="nx">iterable</span><span class="p">,</span> <span class="nx">func</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">iterable</span> <span class="k">instanceof</span> <span class="nb">Array</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">iterable</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="nx">func</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">iterable</span><span class="p">,</span> <span class="nx">iterable</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">iterable</span> <span class="k">instanceof</span> <span class="nb">Object</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="nx">field</span> <span class="k">in</span> <span class="nx">iterable</span><span class="p">)</span> <span class="nx">func</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">iterable</span><span class="p">,</span> <span class="nx">iterable</span><span class="p">[</span><span class="nx">field</span><span class="p">],</span> <span class="nx">field</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div><h3 id="quick-class-construction-single-inheritance-one-function"><a href="#quick-class-construction-single-inheritance-one-function" title="Quick Class Construction (Single Inheritance, one function)">Quick Class Construction (Single Inheritance, one function)</a></h3>
<p>This is just a slightly modified version from <a href="http://www.willmcgugan.com/blog/tech/2009/12/5/javascript-snippets/">this nice article</a>. Also, <code>bind</code> function is useful to make stuff like this: <code>var catMeow = bind(cat, Cat.meow);</code>.</p>
<div class="code"><div><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35</pre></div></td><td class="code"><div class="highlight"><pre><span class="kd">function</span> <span class="nx">class_</span><span class="p">(</span><span class="nx">def</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">_proto</span> <span class="o">=</span> <span class="nx">def</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">def</span><span class="p">[</span><span class="s1">&#39;_extends&#39;</span><span class="p">]</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">_ex</span> <span class="o">=</span> <span class="nx">def</span><span class="p">[</span><span class="s1">&#39;_extends&#39;</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">_ex</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">each</span><span class="p">(</span><span class="nx">_ex</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">v</span><span class="p">,</span> <span class="nx">k</span><span class="p">){</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">_proto</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">_proto</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="o">=</span> <span class="nx">v</span><span class="p">;</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="nx">_proto</span><span class="p">[</span><span class="s1">&#39;_s_&#39;</span><span class="o">+</span><span class="nx">k</span><span class="p">]</span> <span class="o">=</span> <span class="nx">v</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">});</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Wrong _extends field&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">_init</span> <span class="o">=</span> <span class="nx">def</span><span class="p">[</span><span class="s1">&#39;_init&#39;</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">_init</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">_init</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">prototype</span><span class="p">[</span><span class="s1">&#39;_s__init&#39;</span><span class="p">])</span> <span class="k">this</span><span class="p">.</span><span class="nx">_init_super</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="nx">_init</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nx">_proto</span><span class="p">;</span>

    <span class="nx">def</span><span class="p">[</span><span class="s1">&#39;hasOwnProperty&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">k</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span><span class="nx">k</span> <span class="o">!==</span> <span class="s1">&#39;hasOwnProperty&#39;</span><span class="p">)</span>
               <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">k</span><span class="p">)</span>
                  <span class="o">||</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">_proto</span><span class="p">,</span> <span class="nx">k</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">_init</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">bind</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">method</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">method</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div><h4 id="usage"><a href="#usage" title="Usage">Usage</a></h4><div class="code"><div><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42</pre></div></td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">Base</span> <span class="o">=</span> <span class="nx">class_</span><span class="p">({</span>

    <span class="nx">_init</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">a</span> <span class="o">=</span> <span class="nx">a</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">b</span> <span class="o">=</span> <span class="nx">b</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">someMethod</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;parent&#39;</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">});</span>

<span class="kd">var</span> <span class="nx">Child</span> <span class="o">=</span> <span class="nx">class_</span><span class="p">({</span>

    <span class="nx">_extends</span><span class="o">:</span> <span class="nx">Base</span><span class="p">,</span>

    <span class="nx">_init</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_s__init</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">c</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">a</span><span class="p">);</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">b</span><span class="p">);</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">c</span><span class="p">);</span>
    <span class="p">},</span>

    <span class="nx">someMethod</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_s_someMethod</span><span class="p">();</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;child&#39;</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">});</span>

<span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Base</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">c</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Child</span><span class="p">();</span>

<span class="nx">b</span><span class="p">.</span><span class="nx">someMethod</span><span class="p">();</span>
<span class="nx">c</span><span class="p">.</span><span class="nx">someMethod</span><span class="p">();</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">b</span> <span class="k">instanceof</span> <span class="nx">Base</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">b</span> <span class="k">instanceof</span> <span class="nx">Child</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">c</span> <span class="k">instanceof</span> <span class="nx">Base</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">c</span> <span class="k">instanceof</span> <span class="nx">Child</span><span class="p">);</span>
</pre></div>
</td></tr></table></div></div><h3 id="easy-assertions-mechanism-one-or-two-functions"><a href="#easy-assertions-mechanism-one-or-two-functions" title="Easy assertions mechanism (one or two functions)">Easy assertions mechanism (one or two functions)</a></h3>
<p>Just for quick TDD, if you like it. If you need only assertions, not a tests suites, take just <code>AssertException</code> and <code>assert</code> function - they are everything you need. Else, <code>runTests</code> allows you to run <code>JUnit</code>-like tests suites, even with proper <code>setUp</code> and <code>tearDown</code>. (Uses console to inform about tests results so in the presented form it may work only in Firefox / WebKit browsers)</p>
<div class="code"><div><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85</pre></div></td><td class="code"><div class="highlight"><pre><span class="kd">function</span> <span class="nx">AssertException</span><span class="p">(</span><span class="nx">result</span><span class="p">,</span> <span class="nx">expectation</span><span class="p">)</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">result</span> <span class="o">=</span> <span class="nx">result</span><span class="p">;</span>
                                                <span class="k">this</span><span class="p">.</span><span class="nx">expectation</span> <span class="o">=</span> <span class="nx">expectation</span><span class="p">;</span> <span class="p">}</span>
<span class="nx">AssertException</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">expectation</span><span class="p">)</span> <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;AssertException: Expected: &#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">expectation</span> <span class="o">+</span> <span class="s1">&#39; Got: &#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">result</span><span class="p">);</span>
    <span class="k">else</span> <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;AssertException: Got: &#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">result</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * Tiny assert</span>
<span class="cm"> * @param {Boolean} test the expression to test</span>
<span class="cm"> * @param {String} [_expectation] what was expected</span>
<span class="cm"> * @throws {AssertException} if assertion was failed</span>
<span class="cm"> */</span>
<span class="kd">function</span> <span class="nx">assert</span><span class="p">(</span><span class="nx">test</span><span class="p">,</span> <span class="nx">_expectation</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">test</span><span class="p">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="nx">AssertException</span><span class="p">(</span><span class="nx">test</span><span class="p">,</span> <span class="nx">_expectation</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">_assert</span><span class="p">(</span><span class="nx">test</span><span class="p">,</span> <span class="nx">val</span><span class="p">,</span> <span class="nx">expectation</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">test</span><span class="p">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="nx">AssertException</span><span class="p">(</span><span class="nx">val</span><span class="p">,</span> <span class="nx">expectation</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">assertNotNull</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span> <span class="nx">_assert</span><span class="p">(</span><span class="nx">test</span> <span class="o">!==</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">test</span> <span class="o">+</span> <span class="s1">&#39; == null&#39;</span><span class="p">,</span> <span class="s1">&#39;not null&#39;</span><span class="p">);</span> <span class="p">}</span>
<span class="kd">function</span> <span class="nx">assertDefined</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span> <span class="nx">_assert</span><span class="p">(</span><span class="nx">test</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">,</span> <span class="nx">test</span> <span class="o">+</span> <span class="s1">&#39; !== undefined&#39;</span><span class="p">,</span> <span class="s1">&#39;defined&#39;</span><span class="p">);</span> <span class="p">}</span>
<span class="kd">function</span> <span class="nx">assertTrue</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span> <span class="nx">_assert</span><span class="p">(</span><span class="nx">test</span><span class="p">,</span> <span class="nx">test</span> <span class="o">+</span> <span class="s1">&#39; != true&#39;</span><span class="p">,</span> <span class="s1">&#39;true&#39;</span><span class="p">);</span> <span class="p">}</span>
<span class="kd">function</span> <span class="nx">assertFalse</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span> <span class="nx">_assert</span><span class="p">(</span><span class="o">!</span><span class="nx">test</span><span class="p">,</span> <span class="nx">test</span> <span class="o">+</span> <span class="s1">&#39; != false&#39;</span><span class="p">,</span> <span class="s1">&#39;false&#39;</span><span class="p">);</span> <span class="p">}</span>
<span class="kd">function</span> <span class="nx">assertEquals</span><span class="p">(</span><span class="nx">first</span><span class="p">,</span> <span class="nx">second</span><span class="p">)</span> <span class="p">{</span> <span class="nx">_assert</span><span class="p">(</span><span class="nx">first</span> <span class="o">===</span> <span class="nx">second</span><span class="p">,</span> <span class="nx">first</span> <span class="o">+</span> <span class="s1">&#39; != &#39;</span> <span class="o">+</span> <span class="nx">second</span><span class="p">,</span> <span class="nx">second</span> <span class="o">+</span> <span class="s1">&#39; == &#39;</span> <span class="o">+</span> <span class="nx">second</span><span class="p">);</span> <span class="p">}</span>
<span class="kd">function</span> <span class="nx">assertInstance</span><span class="p">(</span><span class="nx">test</span><span class="p">,</span> <span class="nx">cls</span><span class="p">)</span> <span class="p">{</span> <span class="nx">_assert</span><span class="p">(</span><span class="nx">test</span> <span class="k">instanceof</span> <span class="nx">cls</span><span class="p">,</span> <span class="nx">test</span> <span class="o">+</span> <span class="s1">&#39; not instance of &#39;</span> <span class="o">+</span> <span class="nx">cls</span><span class="p">,</span> <span class="nx">test</span> <span class="o">+</span> <span class="s1">&#39; instance of &#39;</span> <span class="o">+</span> <span class="nx">cls</span><span class="p">);</span> <span class="p">}</span>
<span class="kd">function</span> <span class="nx">assertType</span><span class="p">(</span><span class="nx">test</span><span class="p">,</span> <span class="nx">typename</span><span class="p">)</span> <span class="p">{</span> <span class="nx">_assert</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">test</span> <span class="o">==</span> <span class="nx">typename</span><span class="p">,</span> <span class="nx">test</span> <span class="o">+</span> <span class="s1">&#39; is not of type &#39;</span> <span class="o">+</span> <span class="nx">typename</span><span class="p">,</span> <span class="nx">test</span> <span class="o">+</span> <span class="s1">&#39; has type &#39;</span> <span class="o">+</span> <span class="nx">typename</span><span class="p">);</span> <span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * Tests runner</span>
<span class="cm"> * @param {Object, Function} suite for function-typed parameter,</span>
<span class="cm">                                       calls a function and informs through Firebug console about assertions</span>
<span class="cm">                                   for object-typed parameter,</span>
<span class="cm">                                       works like JUnit, calls every method which name starts with &#39;test...&#39;</span>
<span class="cm">                                       also calls &#39;setUp&#39; and &#39;tearDown&#39; in the proper moments</span>
<span class="cm">                                       informs through Firebug console about assertions and passed/failed methods</span>
<span class="cm"> * @param {String} [_name] some name for test case or test suite (used only in logs to help you determine what failed)</span>
<span class="cm"> * @param {String} [_stopWhenFailed] for object-mode, stops testing when first assertion is failed in some method</span>
<span class="cm"> * @returns {AssertException} first failed exception for function-mode, nothing for object-mode</span>
<span class="cm"> *</span>
<span class="cm"> * runTests(new SomeClass());</span>
<span class="cm"> * runTests(someFunc(), &#39;someFunc&#39;);</span>
<span class="cm"> */</span>
<span class="kd">var</span> <span class="nx">__tCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nx">__fCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kd">function</span> <span class="nx">runTests</span><span class="p">(</span><span class="nx">suite</span><span class="p">,</span> <span class="nx">_name</span><span class="p">,</span> <span class="nx">_stopWhenFailed</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">suite</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span> <span class="nx">__fCount</span><span class="o">++</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">field</span> <span class="o">=</span> <span class="p">(</span><span class="nx">_name</span> <span class="o">?</span> <span class="nx">_name</span> <span class="o">:</span> <span class="p">(</span><span class="s1">&#39;Function &#39;</span> <span class="o">+</span> <span class="nx">__fCount</span><span class="p">));</span>
        <span class="k">try</span> <span class="p">{</span> <span class="nx">suite</span><span class="p">();</span>
              <span class="nx">console</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s1">&#39;%s: %s&#39;</span><span class="p">,</span> <span class="nx">field</span><span class="p">,</span> <span class="s1">&#39;OK&#39;</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">ex</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">ex</span> <span class="k">instanceof</span> <span class="nx">AssertException</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">info_</span> <span class="o">=</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="nx">field</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">ex</span><span class="p">.</span><span class="nx">lineNumber</span><span class="p">)</span> <span class="nx">info_</span> <span class="o">+=</span> <span class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="nx">ex</span><span class="p">.</span><span class="nx">lineNumber</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">ex</span><span class="p">.</span><span class="nx">expectation</span><span class="p">)</span>  <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Assertion failed. Expected:&#39;</span><span class="p">,</span> <span class="nx">ex</span><span class="p">.</span><span class="nx">expectation</span><span class="p">,</span>
                                                    <span class="s1">&#39;. Got:&#39;</span><span class="p">,</span> <span class="nx">ex</span><span class="p">.</span><span class="nx">result</span><span class="p">,</span> <span class="nx">info_</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">);</span>
                <span class="k">else</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Assertion failed. Got:&#39;</span><span class="p">,</span> <span class="nx">ex</span><span class="p">.</span><span class="nx">result</span><span class="p">,</span> <span class="nx">info_</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">);</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">ex</span><span class="p">);</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s1">&#39;%s: %s&#39;</span><span class="p">,</span> <span class="nx">field</span><span class="p">,</span> <span class="s1">&#39;FAILED&#39;</span><span class="p">);</span>
                <span class="k">return</span> <span class="nx">ex</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="nx">ex</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">suite</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span> <span class="p">{</span> <span class="nx">__tCount</span><span class="o">++</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">title</span> <span class="o">=</span> <span class="nx">_name</span> <span class="o">||</span> <span class="p">(</span><span class="s2">&quot;Suite &quot;</span> <span class="o">+</span> <span class="nx">__tCount</span><span class="p">);</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">group</span><span class="p">(</span><span class="nx">title</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">field</span> <span class="k">in</span> <span class="nx">suite</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">((</span><span class="k">typeof</span> <span class="nx">suite</span><span class="p">[</span><span class="nx">field</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
                <span class="p">(</span><span class="nx">field</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">suite</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">field</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Running&#39;</span><span class="p">,</span> <span class="nx">title</span> <span class="o">+</span> <span class="s1">&#39; / &#39;</span> <span class="o">+</span> <span class="nx">field</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">suite</span><span class="p">.</span><span class="nx">setUp</span><span class="p">)</span> <span class="nx">suite</span><span class="p">.</span><span class="nx">setUp</span><span class="p">();</span>
                <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">runTests</span><span class="p">(</span><span class="nx">bind</span><span class="p">(</span><span class="nx">suite</span><span class="p">,</span> <span class="nx">suite</span><span class="p">[</span><span class="nx">field</span><span class="p">]),</span> <span class="nx">field</span><span class="p">);</span>
                <span class="kd">var</span> <span class="nx">passed</span> <span class="o">=</span> <span class="p">(</span><span class="nx">result</span> <span class="o">===</span> <span class="kc">null</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">_stopWhenFailed</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">result</span> <span class="o">!==</span> <span class="kc">null</span><span class="p">))</span> <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">suite</span><span class="p">.</span><span class="nx">tearDown</span><span class="p">)</span> <span class="nx">suite</span><span class="p">.</span><span class="nx">tearDown</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">groupEnd</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nx">Exception</span><span class="p">(</span><span class="s1">&#39;Passed var has invalid type&#39;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div></div><h4 id="examples"><a href="#examples" title="Examples">Examples</a></h4><div class="code"><div><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48</pre></div></td><td class="code"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">T1</span> <span class="o">=</span> <span class="nx">class_</span><span class="p">({</span>

   <span class="nx">_init</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>  <span class="p">},</span>

   <span class="nx">setUp</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="p">},</span>

   <span class="nx">test1</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
       <span class="nx">assert</span><span class="p">(</span><span class="kc">null</span> <span class="o">==</span> <span class="kc">null</span><span class="p">);</span>
       <span class="nx">assert</span><span class="p">(</span><span class="mi">12</span> <span class="o">==</span> <span class="kc">null</span><span class="p">,</span> <span class="s1">&#39;12 == null&#39;</span><span class="p">);</span>
       <span class="nx">assert</span><span class="p">(</span><span class="s1">&#39;a&#39;</span> <span class="o">==</span> <span class="kc">null</span><span class="p">);</span>
       <span class="nx">assertTrue</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
       <span class="nx">assertFalse</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
       <span class="nx">assertTrue</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
       <span class="nx">assertFalse</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
       <span class="nx">assertEquals</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">5.1</span><span class="p">);</span>
       <span class="nx">assertEquals</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
       <span class="nx">assertEquals</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;ab&#39;</span><span class="p">);</span>
       <span class="nx">assertEquals</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span>
       <span class="nx">assertType</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;integer&#39;</span><span class="p">);</span>
       <span class="nx">assertType</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">);</span>
       <span class="nx">assertType</span><span class="p">(</span><span class="s1">&#39;12&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">);</span>
       <span class="nx">assertInstance</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">T1</span><span class="p">);</span>
       <span class="nx">assertInstance</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nb">Object</span><span class="p">);</span>
       <span class="nx">assertInstance</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nb">Object</span><span class="p">);</span>
       <span class="nx">assertNotNull</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
       <span class="nx">assertNotNull</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
   <span class="p">},</span>

   <span class="nx">test2</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
       <span class="c1">//throw new Error(&#39;Alala&#39;);</span>
       <span class="nx">assertEquals</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mf">7.2</span><span class="p">);</span>
   <span class="p">},</span>

   <span class="nx">tearDown</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>

<span class="p">});</span>

<span class="kd">var</span> <span class="nx">_f</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">assertTrue</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
    <span class="nx">assertEquals</span><span class="p">(</span><span class="s1">&#39;12&#39;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">runTests</span><span class="p">(</span><span class="k">new</span> <span class="nx">T1</span><span class="p">());</span>
<span class="nx">runTests</span><span class="p">(</span><span class="nx">_f</span><span class="p">,</span> <span class="s1">&#39;_f&#39;</span><span class="p">);</span>

<span class="k">new</span> <span class="nx">T1</span><span class="p">().</span><span class="nx">test1</span><span class="p">();</span>

<span class="nx">_f</span><span class="p">();</span>
</pre></div>
</td></tr></table></div></div><h3 id="snippets-tests"><a href="#snippets-tests" title="Snippets tests">Snippets tests</a></h3>
<p>Using TDD-snippet, I wrote a general Test Suite for all of three snippets to demonstrate their interaction.</p>

<p><a href="http://paste.pocoo.org/show/344963/">Test Suite</a> | <a href="http://pastie.org/pastes/1585157">All snippets</a></p>

        </div>
    </article>

        </div>
        
        
            <ul id="nwao-social">
    <li><a href="https://twitter.com/#!/shaman_sir" title="Twitter profile"><img src="/blog/assets/img/social/twitter.png" width="16" height="16" alt="Twitter profile"></a></li>
    <li><a href="https://github.com/shamansir" title="Github profile"><img src="/blog/assets/img/social/github.png" width="16" height="16" alt="GitHub profile"></a></li>                
    
    <li><a href="https://www.facebook.com/shaman.sir" title="Facebook profile"><img src="/blog/assets/img/social/facebook.png" width="16" height="16" alt="Facebook profile"></a></li>
    
    
    <li><a href="http://stackoverflow.com/users/167262" title="Stackoverflow profile"><img src="/blog/assets/img/social/stack-overflow.png" width="16" height="16" alt="Stack Overflow profile"></a></li>
    
</ul>
        

        <div id="nwao-footer">
            <p>Copyright &copy; 2012 Ulric Wilfred &ndash; powered by <a href="http://mynt.mirroredwhite.com/">mynt</a></p>
        </div>

        <div id="nwao-jump-to-top"><a href="#top" title="Jump to top">&#x2912;</a></div>

        <!--
        <script type="text/javascript" src="/blog/assets/js/scrolls.js"></script>
        <script type="text/javascript" src="/blog/assets/js/page.scrolls.js"></script> -->


        </script>
    </div>

    <div id="nwao-onion"></div>
</body>
</html>